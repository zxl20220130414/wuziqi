<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Five in a Row</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        background-color: #f3f3f3;
      }

      .game {
        text-align: center;
      }

      .game-status {
        margin-bottom: 20px;
        font-size: 20px;
        font-weight: bold;
      }

      .board {
        display: grid;
        grid-template-columns: repeat(15, 40px);
        grid-template-rows: repeat(15, 40px);
        gap: 2px;
        justify-content: center;
      }

      .square {
        width: 40px;
        height: 40px;
        background-color: #fff;
        border: 1px solid #ccc;
        font-size: 24px;
        font-weight: bold;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        user-select: none;
      }

      .square:focus {
        outline: none;
      }

      .square:hover {
        background-color: #f0f0f0;
      }

      button:disabled {
        cursor: not-allowed;
        background-color: #e0e0e0;
      }
    </style>
  </head>

  <body>
    <div id="root"></div>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script>
      const { useState } = React;

      const boardSize = 15;  // 五子棋的棋盘大小

      function App() {
        const [squares, setSquares] = useState(Array(boardSize).fill(null).map(() => Array(boardSize).fill(null)));
        const [isNext, setIsNext] = useState(true); // X 为先手
        const winner = calculateWinner(squares);

        const handleClick = (i, j) => {
          if (squares[i][j] || winner) {
            return;
          }
          const newSquares = squares.slice();
          newSquares[i][j] = isNext ? 'X' : 'O';
          setSquares(newSquares);
          setIsNext(!isNext);
        };

        const renderSquare = (i, j) => {
          return (
            <button
              className="square"
              onClick={() => handleClick(i, j)}
              key={`${i},${j}`}
            >
              {squares[i][j]}
            </button>
          );
        };

        const renderBoard = () => {
          const rows = [];
          for (let i = 0; i < boardSize; i++) {
            const row = [];
            for (let j = 0; j < boardSize; j++) {
              row.push(renderSquare(i, j));
            }
            rows.push(<div key={i} className="board-row">{row}</div>);
          }
          return <div className="board">{rows}</div>;
        };

        const calculateWinner = (squares) => {
          for (let i = 0; i < boardSize; i++) {
            for (let j = 0; j < boardSize; j++) {
              if (squares[i][j] !== null) {
                if (
                  checkDirection(i, j, 1, 0, squares[i][j]) ||  // 横向
                  checkDirection(i, j, 0, 1, squares[i][j]) ||  // 纵向
                  checkDirection(i, j, 1, 1, squares[i][j]) ||  // 主对角线
                  checkDirection(i, j, 1, -1, squares[i][j])    // 副对角线
                ) {
                  return squares[i][j];
                }
              }
            }
          }
          return null;
        };

        const checkDirection = (x, y, dx, dy, player) => {
          let count = 0;
          for (let i = 0; i < 5; i++) {
            const nx = x + dx * i;
            const ny = y + dy * i;
            if (nx < 0 || ny < 0 || nx >= boardSize || ny >= boardSize || squares[nx][ny] !== player) {
              return false;
            }
            count++;
          }
          return count === 5;
        };

        const status = winner ? `Winner: ${winner}` : `Next player: ${isNext ? 'X' : 'O'}`;

        return (
          <div className="game">
            <div className="game-status">{status}</div>
            {renderBoard()}
          </div>
        );
      }

      ReactDOM.render(<App />, document.getElementById('root'));
    </script>
  </body>
</html>
